# 塾管理システム (Attendance & Schedule Management System)

このプロジェクトは、塾の生徒の出席管理、授業のスケジュール管理、振替対応、PCの割り当てなどを一元的に行うためのフルスタックWebアプリケーションです。

## ✨ 主な機能

* **認証:** 管理者向けのログイン・ログアウト機能。
* **ダッシュボード:**
    * リアルタイムで現在の授業の出席状況を確認できる「ライブダッシュボード」。
    * 日付を指定して、その日の授業・出席・欠席予定を一覧できる「デイリー名簿」。
    * 出席記録のない生徒を一覧し、一括で処理する「出席漏れ処理」ページ。
* **データ管理:**
    * **生徒管理:** 生徒の登録、一覧、編集、削除、および通常授業スケジュールの一括設定。
    * **PC管理:** 授業で使用するPCの台帳を管理（追加、削除）。
    * **授業コマ管理:** 「月曜1限」のような、基本的な時間割の枠を管理（追加、削除）。
* **スケジュール管理:**
    * 生徒の振替予定を登録する機能。
    * 全てのスケジュール（通常、振替、欠席）を日付や名前で検索し、編集・削除できる管理機能。
* **システム管理:**
    * データベース全体の情報をCSV形式（ZIP圧縮）でエクスポートするバックアップ機能。
    * バックアップファイルからデータを復元するインポート機能。

## 💻 使用技術

* **バックエンド:** Node.js, Express.js
* **データベース:** SQLite3
* **フロントエンド:** HTML, CSS, Vanilla JavaScript
* **主要ライブラリ:**
    * `express-session`, `cookie-parser`: セッション管理
    * `bcrypt`: パスワードのハッシュ化
    * `multer`: ファイルアップロード処理
    * `archiver`, `unzipper`, `csv-parser`: データのインポート/エクスポート

## 🚀 セットアップと実行方法

### 1. 準備
まず、Node.js v22がインストールされていることを確認してください。

### 2. インストール
リポジトリをクローンし、必要なパッケージをインストールします。

```sh
# リポジトリをクローン
git clone [リポジトリのURL]

# プロジェクトディレクトリに移動
cd [プロジェクト名]

# 必要なパッケージをインストール
npm install
```

### 3. 管理者アカウントの作成
このシステムに最初にログインするための、管理者アカウントを作成します。

1.  プロジェクトのルートにある`create-admin.js`ファイルを開きます。
2.  `const adminPassword = 'password123';`の部分を、あなたが設定したい安全なパスワードに変更します。
3.  ターミナルで以下のコマンドを実行します。

```sh
node create-admin.js
```
成功すれば、`management.db`というデータベースファイル内に管理者アカウントが作成されます。

### 4. サーバーの起動
以下のコマンドでサーバーを起動します。

```sh
node server.js
```
コンソールに`サーバーがポート3000で起動しました。`と表示されれば成功です。

### 5. アクセス
Webブラウザを開き、`http://localhost:3000/login.html`にアクセスして、手順3で設定したユーザー名（デフォルトは`admin`）とパスワードでログインしてください。

## 📝 APIエンドポイント概要

このシステムは、以下の主要なAPIエンドポイントを提供します。

| メソッド | パス                          | 説明                                         |
| :------- | :---------------------------- | :------------------------------------------- |
| `POST`   | `/api/login`                  | 管理者としてログインします。                 |
| `POST`   | `/api/logout`                 | ログアウトします。                           |
| `GET`    | `/api/users`                  | 全生徒の一覧を取得します（名前での検索も可）。 |
| `POST`   | `/api/users`                  | 新しい生徒を登録します。                     |
| `PUT`    | `/api/users/:id`              | 特定の生徒の情報を更新します。               |
| `GET`    | `/api/schedules`              | 日付範囲、ステータス、名前などでスケジュールを検索します。 |
| `POST`   | `/api/schedules/bulk`         | 生徒の通常授業を長期間にわたり一括登録します。 |
| `GET`    | `/api/live/current-class`     | 現在進行中の授業の出席状況を取得します。     |
| `GET`    | `/api/daily-roster`           | 指定した日付の全授業予定を取得します。       |
| `GET`    | `/api/export`                 | 全データをZIP(CSV)形式でエクスポートします。   |
| `POST`   | `/api/import`                 | ZIP(CSV)形式のバックアップからデータをインポートします。 |
など
